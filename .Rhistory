scdata$New_celltype[scdata$New_celltype=="4"]<-"hRSLCs"
scdata$New_celltype[scdata$New_celltype=="5"]<-"RPC/PC/AC_HC/BC/MC"
saveRDS(scdata,"D:\\OneDrive\\类器官空间\\DEanalysis\\H9_D60_2_final_stdata.rds")
read.delim("D:\\OneDrive\\类器官空间\\H9_D60_decon_mtrx.txt",header = T,sep="\t")->decon_mtrx
meta.data<-scdata@meta.data
cell_id<-intersect(rownames(meta.data),rownames(decon_mtrx))
decon_mtrx[cell_id,"cluster"]<-meta.data[cell_id,"seurat_clusters"]
na.omit(decon_mtrx)->decon_mtrx
#计算每个cluster,每一列细胞类型的平均比例
mean_list<-list()
for (i in 1:6){
cluster<-i-1
decon_mtrx[decon_mtrx$cluster==cluster,1:(ncol(decon_mtrx)-1)]->sub_decon_mtrx
colMeans(sub_decon_mtrx)->sub_decon_mtrx_mean
mean_list[[i]]<-sub_decon_mtrx_mean
}
rownames(meta.data)
read.delim("D:\\OneDrive\\类器官空间\\H9_D60_decon_mtrx.txt",header = T,sep="\t")->decon_mtrx
meta.data<-scdata@meta.data
cell_id<-intersect(rownames(meta.data),rownames(decon_mtrx))
decon_mtrx[cell_id,"cluster"]<-meta.data[cell_id,"New_celltype"]
na.omit(decon_mtrx)->decon_mtrx
head(decon_mtrx)
mean_list<-list()
for (i in unique(decon_mtrx$cluster)){
decon_mtrx[decon_mtrx$cluster==i,1:(ncol(decon_mtrx)-1)]->sub_decon_mtrx
colMeans(sub_decon_mtrx)->sub_decon_mtrx_mean
mean_list[[i]]<-sub_decon_mtrx_mean
}
mean_list
as.data.frame(do.call(rbind,mean_list))->mean_df
rownames(mean_df)<-names(mean_list)
mean_list
mean_df
write.csv(mean_df,"D:\\OneDrive\\类器官空间\\DEanalysis\\spatial_cluster_decon_mtrx_mean.csv",row.names = T)
mean_df
data <- data.frame(
category = rownames(mean_df),
proportion = mean_df$BCs
)
data$ymax <- cumsum(data$proportion)
data$ymin <- c(0, head(data$ymax, n = -1))
ggplot(data, aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = category)) +
geom_rect() +
coord_polar(theta = "y") +
xlim(c(2, 4)) +
theme_void() +
theme(legend.position = "bottom") +
labs(title = "Circle Donut Chart")
data
mean_df
data <- data.frame(
category = colnames(mean_df),
proportion = mean_df[1,]
)
colnames(mean_df)
mean_df[1,]
data <- data.frame(
category = colnames(mean_df),
proportion = unlist(mean_df[1,])
)
data
data$ymax <- cumsum(data$proportion)
data$ymin <- c(0, head(data$ymax, n = -1))
# 绘制圆环图
ggplot(data, aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = category)) +
geom_rect() +
coord_polar(theta = "y") +
xlim(c(2, 4)) +
theme_void() +
theme(legend.position = "bottom") +
labs(title = "Circle Donut Chart")
max_proportion <- max(data$proportion)
max_category <- data$category[data$proportion == max_proportion]
p <- ggplot(data, aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = category)) +
geom_rect() +
coord_polar(theta = "y") +
xlim(c(2, 4)) +
theme_void() +
theme(legend.position = "bottom") +
labs(title = "Circle Donut Chart")
# 添加黑色边框到最大比例的细胞类型
p + geom_rect(data = data[data$category == max_category, ],
aes(xmax = 4.1, xmin = 2.9, ymax = ymax, ymin = ymin),
color = "black", fill = NA)
p
max_category
ggplot(data, aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = category)) +
geom_rect() +
coord_polar(theta = "y") +
xlim(c(2, 4)) +
theme_void() +
theme(legend.position = "bottom") +
labs(title = "Circle Donut Chart")
mean_df
ggplot(data, aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = category)) +
geom_rect() +
coord_polar(theta = "y") +
xlim(c(2, 4)) +
theme_void() +
theme(legend.position = "bottom") +
labs(title = rownames(mean_df)[i])+
scale_fill_manual(values = c("#F8766D", "#00BA38", "#619CFF", "#F564E3", "#00BFC4", "#F9BF3B"))
getwd()
save.image("D:\\OneDrive\\类器官空间\\DEanalysis\\.RData")
devtools::load_all(".")
library(scPagwas)
system.time(
#1.start to run the wrapper functions for example.
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"), # The GWAS Summary statistics files
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),# scRNA-seq data in seruat format with "RNA" assays and normalized.
output.prefix="test", # the prefix name for output files
output.dirs="scPagwastest_output",# the directory file's name for output
block_annotation = block_annotation,# gene position in chromosome is provided by package.
assay="RNA", # the assays for scRNA-seq data to use.
Pathway_list=Genes_by_pathway_kegg,# pathway list is provided by package, including gene symbols.
n.cores=1,
iters_singlecell = 10,
chrom_ld = chrom_ld,# The LD data is provided by package.
singlecell=T, # Whether to run the singlecell process.
celltype=T# Whether to run the celltype process.
)
)
##------ Tue Aug  8 16:54:10 2023 ------##
##------ Tue Aug  8 16:54:14 2023 ------##
##------ Tue Aug  8 16:54:44 2023 ------##
##------ Tue Aug  8 16:54:44 2023 ------##
##------ Tue Aug  8 16:54:45 2023 ------##
##------ Tue Aug  8 16:54:45 2023 ------##
##------ Tue Aug  8 16:55:04 2023 ------##
##------ Tue Aug  8 16:55:05 2023 ------##
##------ Tue Aug  8 16:55:08 2023 ------##
devtools::document()
pkgdown::build_site()
devtools::document()
devtools::document()
library(scPagwas)
Pathway_pcascore_run
Pathway_pcascore_run
devtools::load_all(".")
library(scPagwas)
system.time(
#1.start to run the wrapper functions for example.
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"), # The GWAS Summary statistics files
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),# scRNA-seq data in seruat format with "RNA" assays and normalized.
output.prefix="test", # the prefix name for output files
output.dirs="scPagwastest_output",# the directory file's name for output
block_annotation = block_annotation,# gene position in chromosome is provided by package.
assay="RNA", # the assays for scRNA-seq data to use.
Pathway_list=Genes_by_pathway_kegg,# pathway list is provided by package, including gene symbols.
n.cores=1,
iters_singlecell = 10,
chrom_ld = chrom_ld,# The LD data is provided by package.
singlecell=T, # Whether to run the singlecell process.
celltype=T# Whether to run the celltype process.
)
)
##------ Wed Aug  9 09:51:40 2023 ------##
##------ Wed Aug  9 09:51:44 2023 ------##
##------ Wed Aug  9 09:52:12 2023 ------##
##------ Wed Aug  9 09:52:12 2023 ------##
##------ Wed Aug  9 09:52:13 2023 ------##
##------ Wed Aug  9 09:52:13 2023 ------##
##------ Wed Aug  9 09:52:31 2023 ------##
##------ Wed Aug  9 09:52:33 2023 ------##
##------ Wed Aug  9 09:52:35 2023 ------##
devtools::document()
library(scPagwas)
devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"), # The GWAS Summary statistics files
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),# scRNA-seq data in seruat format with "RNA" assays and normalized.
output.prefix="test", # the prefix name for output files
output.dirs="scPagwastest_output",# the directory file's name for output
block_annotation = block_annotation,# gene position in chromosome is provided by package.
assay="RNA", # the assays for scRNA-seq data to use.
Pathway_list=Genes_by_pathway_kegg,# pathway list is provided by package, including gene symbols.
n.cores=1,
iters_singlecell = 10,
chrom_ld = chrom_ld,# The LD data is provided by package.
singlecell=T, # Whether to run the singlecell process.
celltype=T# Whether to run the celltype process.
)
##------ Sat Aug 19 14:58:45 2023 ------##
##------ Sat Aug 19 14:58:50 2023 ------##
##------ Sat Aug 19 14:59:21 2023 ------##
##------ Sat Aug 19 14:59:21 2023 ------##
##------ Sat Aug 19 14:59:21 2023 ------##
##------ Sat Aug 19 14:59:22 2023 ------##
##------ Sat Aug 19 14:59:40 2023 ------##
##------ Sat Aug 19 14:59:41 2023 ------##
##------ Sat Aug 19 14:59:44 2023 ------##
devtools::load_all(".")
devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"), # The GWAS Summary statistics files
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),# scRNA-seq data in seruat format with "RNA" assays and normalized.
output.prefix="test", # the prefix name for output files
output.dirs="scPagwastest_output",# the directory file's name for output
block_annotation = block_annotation,# gene position in chromosome is provided by package.
assay="RNA", # the assays for scRNA-seq data to use.
Pathway_list=Genes_by_pathway_kegg,# pathway list is provided by package, including gene symbols.
n.cores=1,
iters_singlecell = 10,
chrom_ld = chrom_ld,# The LD data is provided by package.
singlecell=T, # Whether to run the singlecell process.
celltype=T# Whether to run the celltype process.
)
##------ Sat Aug 19 15:02:06 2023 ------##
##------ Sat Aug 19 15:02:10 2023 ------##
##------ Sat Aug 19 15:02:24 2023 ------##
##------ Sat Aug 19 15:02:24 2023 ------##
##------ Sat Aug 19 15:02:24 2023 ------##
##------ Sat Aug 19 15:02:25 2023 ------##
##------ Sat Aug 19 15:02:41 2023 ------##
##------ Sat Aug 19 15:02:41 2023 ------##
##------ Sat Aug 19 15:02:43 2023 ------##
devtools::load_all(".")
scPagwas_Visualization(Single_data=Pagwas_data,
p_thre = 0.05,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "white",
highColor = "red",
output.dirs="figure",
size = 0.5,
do_plot = T)
scPagwas_Visualization(Single_data=Pagwas_data,
p_thre = 0.05,
FigureType = "umap",
width = 7,
height = 7,
lowColor = "white",
highColor = "red",
output.dirs="figure",
size = 0.5,
do_plot = T)
devtools::load_all(".")
scPagwas_Visualization(Single_data=Pagwas_data,
p_thre = 0.05,
FigureType = "umap",
width = 7,
height = 7,
lowColor = "white",
highColor = "red",
output.dirs="figure",
size = 0.5,
do_plot = T)
devtools::load_all(".")
scPagwas_Visualization(Single_data=Pagwas_data,
p_thre = 0.05,
FigureType = "umap",
width = 7,
height = 7,
lowColor = "white",
highColor = "red",
output.dirs="figure",
size = 0.5,
do_plot = T)
devtools::document()
library(scPagwas)
usethis::use_pkgdown()
pkgdown::build_site()
library(SPOTlight)
devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"), # The GWAS Summary statistics files
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),# scRNA-seq data in seruat format with "RNA" assays and normalized.
output.prefix="test", # the prefix name for output files
output.dirs="scPagwastest_output",# the directory file's name for output
block_annotation = block_annotation,# gene position in chromosome is provided by package.
assay="RNA", # the assays for scRNA-seq data to use.
Pathway_list=Genes_by_pathway_kegg,# pathway list is provided by package, including gene symbols.
n.cores=1,
iters_singlecell = 10,
chrom_ld = chrom_ld,# The LD data is provided by package.
singlecell=T, # Whether to run the singlecell process.
celltype=T# Whether to run the celltype process.
)
##------ Wed Aug 23 14:27:57 2023 ------##
##------ Wed Aug 23 14:28:03 2023 ------##
##------ Wed Aug 23 14:28:34 2023 ------##
##------ Wed Aug 23 14:28:34 2023 ------##
##------ Wed Aug 23 14:28:34 2023 ------##
##------ Wed Aug 23 14:28:35 2023 ------##
##------ Wed Aug 23 14:28:53 2023 ------##
##------ Wed Aug 23 14:28:54 2023 ------##
##------ Wed Aug 23 14:28:56 2023 ------##
devtools::load_all(".")
scPagwas_Visualization(Single_data=Pagwas_data,
p_thre = 0.05,
FigureType = "umap",
width = 7,
height = 7,
lowColor = "white",
highColor = "red",
output.dirs="figure",
size = 0.5,
do_plot = T)
devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"), # The GWAS Summary statistics files
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),# scRNA-seq data in seruat format with "RNA" assays and normalized.
output.prefix="test", # the prefix name for output files
output.dirs="scPagwastest_output",# the directory file's name for output
block_annotation = block_annotation,# gene position in chromosome is provided by package.
assay="RNA", # the assays for scRNA-seq data to use.
Pathway_list=Genes_by_pathway_kegg,# pathway list is provided by package, including gene symbols.
n.cores=1,
iters_singlecell = 10,
chrom_ld = chrom_ld,# The LD data is provided by package.
singlecell=T, # Whether to run the singlecell process.
celltype=T# Whether to run the celltype process.
)
##------ Wed Aug 23 15:24:14 2023 ------##
##------ Wed Aug 23 15:24:21 2023 ------##
##------ Wed Aug 23 15:24:33 2023 ------##
##------ Wed Aug 23 15:24:34 2023 ------##
##------ Wed Aug 23 15:24:34 2023 ------##
##------ Wed Aug 23 15:24:35 2023 ------##
##------ Wed Aug 23 15:24:53 2023 ------##
##------ Wed Aug 23 15:24:56 2023 ------##
##------ Wed Aug 23 15:24:58 2023 ------##
devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"), # The GWAS Summary statistics files
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),# scRNA-seq data in seruat format with "RNA" assays and normalized.
output.prefix="test", # the prefix name for output files
output.dirs="scPagwastest_output",# the directory file's name for output
block_annotation = block_annotation,# gene position in chromosome is provided by package.
assay="RNA", # the assays for scRNA-seq data to use.
Pathway_list=Genes_by_pathway_kegg,# pathway list is provided by package, including gene symbols.
n.cores=1,
iters_singlecell = 10,
chrom_ld = chrom_ld,# The LD data is provided by package.
singlecell=T, # Whether to run the singlecell process.
celltype=T# Whether to run the celltype process.
)
##------ Wed Aug 23 15:28:18 2023 ------##
##------ Wed Aug 23 15:28:21 2023 ------##
##------ Wed Aug 23 15:28:34 2023 ------##
##------ Wed Aug 23 15:28:34 2023 ------##
##------ Wed Aug 23 15:28:34 2023 ------##
##------ Wed Aug 23 15:28:34 2023 ------##
##------ Wed Aug 23 15:28:51 2023 ------##
##------ Wed Aug 23 15:28:53 2023 ------##
##------ Wed Aug 23 15:28:55 2023 ------##
Pagwas <- list()
Single_data <- readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
Pagwas <- Single_data_input(
Pagwas = Pagwas,
assay = "RNA",
Single_data = Single_data,
Pathway_list = Genes_by_pathway_kegg
)
Single_data <- Single_data[, colnames(Pagwas$data_mat)]
Pagwas <- Pathway_pcascore_run(
Pagwas = Pagwas,
Pathway_list = Genes_by_pathway_kegg
)
gwas_data <- bigreadr::fread2(system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"))
Pagwas <- GWAS_summary_input(
Pagwas = Pagwas,
gwas_data = gwas_data,
maf_filter = 0.1
)
Pagwas$snp_gene_df <- SnpToGene(
gwas_data = Pagwas$gwas_data,
block_annotation = block_annotation,
marg = 10000
)
Pagwas <- Pathway_annotation_input(
Pagwas = Pagwas,
block_annotation = block_annotation
)
Pagwas <- Link_pathway_blocks_gwas(
Pagwas = Pagwas,
chrom_ld = chrom_ld,
singlecell = T,
celltype = T,
backingpath="./temp")
Pagwas$lm_results <- Pagwas_perform_regression(Pathway_ld_gwas_data = Pagwas$Pathway_ld_gwas_data)
Pagwas <- Boot_evaluate(Pagwas, bootstrap_iters = 200, part = 0.5)
Pagwas <- scPagwas_perform_score(
Pagwas = Pagwas,
remove_outlier = TRUE
)
Pagwas$PCC <- scPagwas::scGet_PCC(scPagwas.gPAS.score=Pagwas$scPagwas.gPAS.score,
data_mat=Pagwas$data_mat)
mean_gpas<-mean(Pagwas$scPagwas.gPAS.score)
a1<-which(Pagwas$scPagwas.gPAS.score >= mean_gpas)
a2<-which(Pagwas$scPagwas.gPAS.score < mean_gpas)
PCC_up <- scPagwas::scGet_PCC(scPagwas.gPAS.score=Pagwas$scPagwas.gPAS.score[a1],data_mat=Pagwas$data_mat[,a1])
PCC1<- data.frame(PCC=PCC_up,genes=rownames(PCC_up))
PCC1<-PCC1[order(PCC1$PCC,decreasing=T),]
PCC<- data.frame(PCC=PCC1$PCC)
rownames(PCC)<-PCC1$genes
Pagwas$PCC_up<-PCC
PCC_down <- scPagwas::scGet_PCC(scPagwas.gPAS.score=Pagwas$scPagwas.gPAS.score[a2],data_mat=Pagwas$data_mat[,a2])
PCC1<- data.frame(PCC= -PCC_down,genes=rownames(PCC_down))
PCC1<-PCC1[order(PCC1$PCC,decreasing=F),]
PCC<- data.frame(PCC=PCC1$PCC)
rownames(PCC)<-PCC1$genes
Pagwas$PCC_down<-PCC
n_topgenes=500
scPagwas_topgenes <- rownames(Pagwas$PCC)[order(Pagwas$PCC, decreasing = T)[1:n_topgenes]]
scPagwas_upgenes <- rownames(Pagwas$PCC_up)[1:n_topgenes]
scPagwas_downgenes <- rownames(Pagwas$PCC_down)[1:n_topgenes]
Single_data <- Seurat::AddModuleScore(Single_data, assay = "RNA", list(scPagwas_topgenes,scPagwas_upgenes,scPagwas_downgenes), name = c("scPagwas.TRS.Score","scPagwas.upTRS.Score","scPagwas.downTRS.Score"))
colnames(Single_data@meta.data)
devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"), # The GWAS Summary statistics files
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),# scRNA-seq data in seruat format with "RNA" assays and normalized.
output.prefix="test", # the prefix name for output files
output.dirs="scPagwastest_output",# the directory file's name for output
block_annotation = block_annotation,# gene position in chromosome is provided by package.
assay="RNA", # the assays for scRNA-seq data to use.
Pathway_list=Genes_by_pathway_kegg,# pathway list is provided by package, including gene symbols.
n.cores=1,
iters_singlecell = 10,
chrom_ld = chrom_ld,# The LD data is provided by package.
singlecell=T, # Whether to run the singlecell process.
celltype=T# Whether to run the celltype process.
)
##------ Wed Aug 23 15:35:32 2023 ------##
##------ Wed Aug 23 15:35:36 2023 ------##
##------ Wed Aug 23 15:35:48 2023 ------##
##------ Wed Aug 23 15:35:48 2023 ------##
##------ Wed Aug 23 15:35:48 2023 ------##
##------ Wed Aug 23 15:35:49 2023 ------##
##------ Wed Aug 23 15:36:07 2023 ------##
##------ Wed Aug 23 15:36:08 2023 ------##
##------ Wed Aug 23 15:36:10 2023 ------##
devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"), # The GWAS Summary statistics files
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),# scRNA-seq data in seruat format with "RNA" assays and normalized.
output.prefix="test", # the prefix name for output files
output.dirs="scPagwastest_output",# the directory file's name for output
block_annotation = block_annotation,# gene position in chromosome is provided by package.
assay="RNA", # the assays for scRNA-seq data to use.
Pathway_list=Genes_by_pathway_kegg,# pathway list is provided by package, including gene symbols.
n.cores=1,
iters_singlecell = 10,
chrom_ld = chrom_ld,# The LD data is provided by package.
singlecell=T, # Whether to run the singlecell process.
celltype=T# Whether to run the celltype process.
)
##------ Wed Aug 23 15:46:44 2023 ------##
##------ Wed Aug 23 15:46:48 2023 ------##
##------ Wed Aug 23 15:47:01 2023 ------##
##------ Wed Aug 23 15:47:01 2023 ------##
##------ Wed Aug 23 15:47:01 2023 ------##
##------ Wed Aug 23 15:47:01 2023 ------##
##------ Wed Aug 23 15:47:19 2023 ------##
##------ Wed Aug 23 15:47:20 2023 ------##
##------ Wed Aug 23 15:47:22 2023 ------##
devtools::document()
usethis::use_version()
pkgdown::build_site()
devtools::document()
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"), # The GWAS Summary statistics files
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),# scRNA-seq data in seruat format with "RNA" assays and normalized.
output.prefix="test", # the prefix name for output files
output.dirs="scPagwastest_output",# the directory file's name for output
block_annotation = block_annotation,# gene position in chromosome is provided by package.
assay="RNA", # the assays for scRNA-seq data to use.
Pathway_list=Genes_by_pathway_kegg,# pathway list is provided by package, including gene symbols.
n.cores=1,
iters_singlecell = 10,
chrom_ld = chrom_ld,# The LD data is provided by package.
singlecell=T, # Whether to run the singlecell process.
celltype=T# Whether to run the celltype process.
)
##------ Wed Aug 23 16:05:27 2023 ------##
##------ Wed Aug 23 16:05:31 2023 ------##
##------ Wed Aug 23 16:05:44 2023 ------##
##------ Wed Aug 23 16:05:44 2023 ------##
##------ Wed Aug 23 16:05:44 2023 ------##
##------ Wed Aug 23 16:05:45 2023 ------##
##------ Wed Aug 23 16:06:04 2023 ------##
##------ Wed Aug 23 16:06:05 2023 ------##
##------ Wed Aug 23 16:06:07 2023 ------##
devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"), # The GWAS Summary statistics files
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),# scRNA-seq data in seruat format with "RNA" assays and normalized.
output.prefix="test", # the prefix name for output files
output.dirs="scPagwastest_output",# the directory file's name for output
block_annotation = block_annotation,# gene position in chromosome is provided by package.
assay="RNA", # the assays for scRNA-seq data to use.
Pathway_list=Genes_by_pathway_kegg,# pathway list is provided by package, including gene symbols.
n.cores=1,
iters_singlecell = 10,
chrom_ld = chrom_ld,# The LD data is provided by package.
singlecell=T, # Whether to run the singlecell process.
celltype=T# Whether to run the celltype process.
)
##------ Mon Aug 28 10:13:27 2023 ------##
##------ Mon Aug 28 10:13:32 2023 ------##
##------ Mon Aug 28 10:14:06 2023 ------##
##------ Mon Aug 28 10:14:06 2023 ------##
##------ Mon Aug 28 10:14:06 2023 ------##
##------ Mon Aug 28 10:14:08 2023 ------##
##------ Mon Aug 28 10:14:17 2023 ------##
##------ Mon Aug 28 10:14:18 2023 ------##
##------ Mon Aug 28 10:14:20 2023 ------##
